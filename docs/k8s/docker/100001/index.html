<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>聊聊docker | 赵宇博的技术博客</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="沉淀，静待花开">
    
    <link rel="preload" href="/assets/css/0.styles.42a2c9ab.css" as="style"><link rel="preload" href="/assets/js/app.e1cac8e6.js" as="script"><link rel="preload" href="/assets/js/2.1e4db32b.js" as="script"><link rel="preload" href="/assets/js/28.9f795e29.js" as="script"><link rel="prefetch" href="/assets/js/10.7efe6867.js"><link rel="prefetch" href="/assets/js/11.8d285244.js"><link rel="prefetch" href="/assets/js/12.82731479.js"><link rel="prefetch" href="/assets/js/13.ed0802d4.js"><link rel="prefetch" href="/assets/js/14.98182ddd.js"><link rel="prefetch" href="/assets/js/15.c984db9b.js"><link rel="prefetch" href="/assets/js/16.093ae0c0.js"><link rel="prefetch" href="/assets/js/17.ce529c5c.js"><link rel="prefetch" href="/assets/js/18.2c15a004.js"><link rel="prefetch" href="/assets/js/19.73b23a14.js"><link rel="prefetch" href="/assets/js/20.7523a2df.js"><link rel="prefetch" href="/assets/js/21.49151248.js"><link rel="prefetch" href="/assets/js/22.ffeb1ccb.js"><link rel="prefetch" href="/assets/js/23.35c7a608.js"><link rel="prefetch" href="/assets/js/24.885251ad.js"><link rel="prefetch" href="/assets/js/25.c6e546e3.js"><link rel="prefetch" href="/assets/js/26.20f05943.js"><link rel="prefetch" href="/assets/js/27.31bb323b.js"><link rel="prefetch" href="/assets/js/29.c6ca9ffc.js"><link rel="prefetch" href="/assets/js/3.c8f649d0.js"><link rel="prefetch" href="/assets/js/30.5bbe2551.js"><link rel="prefetch" href="/assets/js/31.57ab7c88.js"><link rel="prefetch" href="/assets/js/32.9182738e.js"><link rel="prefetch" href="/assets/js/33.96397894.js"><link rel="prefetch" href="/assets/js/34.c26055a1.js"><link rel="prefetch" href="/assets/js/35.87428ea5.js"><link rel="prefetch" href="/assets/js/36.d61d6964.js"><link rel="prefetch" href="/assets/js/37.4fc0770e.js"><link rel="prefetch" href="/assets/js/38.ba7dbc6d.js"><link rel="prefetch" href="/assets/js/39.131015e3.js"><link rel="prefetch" href="/assets/js/4.beb55bf3.js"><link rel="prefetch" href="/assets/js/40.b3f95375.js"><link rel="prefetch" href="/assets/js/41.29653fc1.js"><link rel="prefetch" href="/assets/js/42.c670b19e.js"><link rel="prefetch" href="/assets/js/43.c6ee8462.js"><link rel="prefetch" href="/assets/js/44.cb4fc067.js"><link rel="prefetch" href="/assets/js/45.5791944b.js"><link rel="prefetch" href="/assets/js/46.64b92c8a.js"><link rel="prefetch" href="/assets/js/47.f58fc03e.js"><link rel="prefetch" href="/assets/js/48.26e810e5.js"><link rel="prefetch" href="/assets/js/49.40a6ecc5.js"><link rel="prefetch" href="/assets/js/5.d78e4b01.js"><link rel="prefetch" href="/assets/js/50.ba8c46ca.js"><link rel="prefetch" href="/assets/js/51.ad5c7c0a.js"><link rel="prefetch" href="/assets/js/52.50fd105b.js"><link rel="prefetch" href="/assets/js/53.2c18a998.js"><link rel="prefetch" href="/assets/js/54.40023573.js"><link rel="prefetch" href="/assets/js/55.228ba16b.js"><link rel="prefetch" href="/assets/js/56.6ea82b2a.js"><link rel="prefetch" href="/assets/js/57.b480c7fe.js"><link rel="prefetch" href="/assets/js/58.a2c7f8aa.js"><link rel="prefetch" href="/assets/js/59.0f638304.js"><link rel="prefetch" href="/assets/js/6.57f1d291.js"><link rel="prefetch" href="/assets/js/60.996badfc.js"><link rel="prefetch" href="/assets/js/61.0e269abd.js"><link rel="prefetch" href="/assets/js/62.2bef7e97.js"><link rel="prefetch" href="/assets/js/63.4ef5e83c.js"><link rel="prefetch" href="/assets/js/64.7fe1087e.js"><link rel="prefetch" href="/assets/js/65.10fe512d.js"><link rel="prefetch" href="/assets/js/7.f3302cb1.js"><link rel="prefetch" href="/assets/js/8.c85d1aba.js"><link rel="prefetch" href="/assets/js/9.5c768040.js">
    <link rel="stylesheet" href="/assets/css/0.styles.42a2c9ab.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="赵宇博的技术博客" class="logo"> <span class="site-name can-hide">赵宇博的技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/data/" class="nav-link">数据库专栏</a></div><div class="nav-item"><a href="/k8s/" class="nav-link router-link-active">k8s专栏</a></div><div class="nav-item"><a href="/dcs/" class="nav-link">分布式专栏</a></div><div class="nav-item"><a href="/linux/" class="nav-link">Linux网络专栏</a></div><div class="nav-item"><a href="/self/" class="nav-link">手写系列专栏</a></div><div class="nav-item"><a href="/more/" class="nav-link">随笔</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/zhaoyb-coder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/fe/" class="nav-link">前端</a></div><div class="nav-item"><a href="/be/" class="nav-link">后端</a></div><div class="nav-item"><a href="/data/" class="nav-link">数据库专栏</a></div><div class="nav-item"><a href="/k8s/" class="nav-link router-link-active">k8s专栏</a></div><div class="nav-item"><a href="/dcs/" class="nav-link">分布式专栏</a></div><div class="nav-item"><a href="/linux/" class="nav-link">Linux网络专栏</a></div><div class="nav-item"><a href="/self/" class="nav-link">手写系列专栏</a></div><div class="nav-item"><a href="/more/" class="nav-link">随笔</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div> <a href="https://github.com/zhaoyb-coder" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>k8s基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>docker</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/k8s/docker/100001/" aria-current="page" class="active sidebar-link">聊聊docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_1-初识-docker" class="sidebar-link">1. 初识 docker</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_1-1-什么是-docker" class="sidebar-link">1.1 什么是 Docker？</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_1-2-为什么要使用-docker" class="sidebar-link">1.2 为什么要使用 Docker？</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_2-核心概念与安装配置" class="sidebar-link">2. 核心概念与安装配置</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_2-1-核心概念" class="sidebar-link">2.1 核心概念</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-1-1-docker-镜像" class="sidebar-link">2.1.1 Docker 镜像</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-1-2-docker-容器" class="sidebar-link">2.1.2 Docker 容器</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-1-3-docker-仓库" class="sidebar-link">2.1.3 Docker 仓库</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-1-4-docker-客户端" class="sidebar-link">2.1.4 Docker 客户端</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-1-5-docker-主机" class="sidebar-link">2.1.5 Docker 主机</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-1-6-docker-machine" class="sidebar-link">2.1.6 Docker Machine</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_2-2-安装配置" class="sidebar-link">2.2 安装配置</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-2-1-linux-下安装最新版本的docker" class="sidebar-link">2.2.1 Linux 下安装最新版本的docker</a></li><li class="sidebar-sub-header level5"><a href="/k8s/docker/100001/#_2-2-1-1-ubuntu" class="sidebar-link">2.2.1.1 UBUNTU</a></li><li class="sidebar-sub-header level5"><a href="/k8s/docker/100001/#_2-2-1-2-centos" class="sidebar-link">2.2.1.2 Centos</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-2-2-windows" class="sidebar-link">2.2.2 Windows</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-2-3-macos" class="sidebar-link">2.2.3 MacOS</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_2-2-4-其他" class="sidebar-link">2.2.4 其他</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_2-3-总体架构图" class="sidebar-link">2.3 总体架构图</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_3-docker-的相关简单命令" class="sidebar-link">3. Docker 的相关简单命令</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_3-1-基础命令" class="sidebar-link">3.1 基础命令</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_3-2-镜像相关命令" class="sidebar-link">3.2 镜像相关命令</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_3-3-容器相关命令" class="sidebar-link">3.3 容器相关命令</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_3-4-其他" class="sidebar-link">3.4 其他</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_4-docker-网络" class="sidebar-link">4. Docker 网络</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_4-1-查看-docker-不启动和启动时的网络情况" class="sidebar-link">4.1 查看 docker 不启动和启动时的网络情况</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_4-2-常用基本命令" class="sidebar-link">4.2 常用基本命令</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_4-3-docker-网络的用途" class="sidebar-link">4.3 Docker 网络的用途</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_4-4-网络模式" class="sidebar-link">4.4 网络模式</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_4-4-1-分类" class="sidebar-link">4.4.1 分类</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_4-4-2-容器实例内默认网络-ip-生产规则" class="sidebar-link">4.4.2 容器实例内默认网络 IP 生产规则</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_4-4-3-简单测试" class="sidebar-link">4.4.3 简单测试</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_4-4-4-端口映射的简单示例" class="sidebar-link">4.4.4 端口映射的简单示例</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_5-dockerfile" class="sidebar-link">5.Dockerfile</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_5-1-基本结构" class="sidebar-link">5.1 基本结构</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_5-1-1-说明" class="sidebar-link">5.1.1 说明</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_5-1-2-基于-debian-jessie-镜像安装nginx-的dockerfile示例" class="sidebar-link">5.1.2 基于 debian:jessie 镜像安装Nginx 的Dockerfile示例</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_5-1-3-基于buildpack-deps-jessie-scm镜像安装golang相关环境的-dockerfile-示例" class="sidebar-link">5.1.3 基于buildpack-deps:jessie-scm镜像安装Golang相关环境的 Dockerfile 示例</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_5-1-4-永远的-helloworld-java" class="sidebar-link">5.1.4 永远的 helloworld(JAVA)</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_5-2-指令说明" class="sidebar-link">5.2 指令说明</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_5-3-最佳实践" class="sidebar-link">5.3 最佳实践</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_5-4-推荐一个-dockerfile-项目" class="sidebar-link">5.4 推荐一个 Dockerfile 项目</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_6-容器实战思考" class="sidebar-link">6.容器实战思考</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_6-1-docker-成功的原因" class="sidebar-link">6.1 Docker 成功的原因</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_6-2-研发人员怎么看-docker" class="sidebar-link">6.2 研发人员怎么看 Docker</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_6-3-容器化开发模式" class="sidebar-link">6.3 容器化开发模式</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_6-3-1-传统开发流程与容器化开发流程" class="sidebar-link">6.3.1 传统开发流程与容器化开发流程</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_6-3-2-一些建议" class="sidebar-link">6.3.2 一些建议</a></li><li class="sidebar-sub-header level3"><a href="/k8s/docker/100001/#_6-4-容器与生产环境" class="sidebar-link">6.4 容器与生产环境</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_6-4-1-为标准而努力" class="sidebar-link">6.4.1 为标准而努力</a></li><li class="sidebar-sub-header level4"><a href="/k8s/docker/100001/#_6-4-2-一些参考建议" class="sidebar-link">6.4.2 一些参考建议</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_7-可继续的docker-相关学习与研究" class="sidebar-link">7.可继续的Docker 相关学习与研究</a></li><li class="sidebar-sub-header level2"><a href="/k8s/docker/100001/#_8-推荐网站与书籍" class="sidebar-link">8. 推荐网站与书籍</a></li></ul></li><li><a href="/k8s/docker/100002/" class="sidebar-link">Cgroup</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/k8s/#k8s专栏" data-v-06225672>k8s专栏</a></li><li data-v-06225672><a href="/k8s/#docker" data-v-06225672>docker</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/zhaoyb-coder" target="_blank" title="作者" class="beLink" data-v-06225672>zhaoyb</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-10-17</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">聊聊docker<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="聊聊docker"><a href="#聊聊docker" class="header-anchor">#</a> 聊聊docker</h1> <h2 id="_1-初识-docker"><a href="#_1-初识-docker" class="header-anchor">#</a> <strong>1.</strong> <strong>初识</strong> <strong>docker</strong></h2> <h3 id="_1-1-什么是-docker"><a href="#_1-1-什么是-docker" class="header-anchor">#</a> <strong>1.1</strong> <strong>什么是</strong> <strong>Docker</strong>？</h3> <ul><li>Docker 是基于 Go 语言实现的开源容器项目，诞生于 2013 年年初，最初发起者是 dotCloud</li></ul> <p>公司.</p> <ul><li><p>Docker 是 Linux 平台上的一款轻量级虚拟化容器的管理引擎.</p></li> <li><p>Docker 利用 Linux 内核特性命名空间(namespaces)及控制组(cgroups)等为容器提供隔离的</p></li></ul> <p>运行环境.</p> <ul><li>Docker 官方如此描述 Docker：“Build，Ship，Run.An open platform for distributed applications</li></ul> <p>for developers and sysadmins”. 换言之，Docker 为<strong>开发者与系统管理者</strong>提供了分布式应用的</p> <p>开放平台，从而可以便捷地构建、迁移与运行分布式应用 .</p> <ul><li>现在官网上介绍它的要做的事情是“<strong>Build-Share-Run</strong>”，也是通过对应用的封装、分发、</li></ul> <p>部署、运行生命周期进行管理，达到应用组件“<strong>一次封装，到处运行</strong>”的目的.</p> <h3 id="_1-2-为什么要使用-docker"><a href="#_1-2-为什么要使用-docker" class="header-anchor">#</a> <strong>1.2</strong> <strong>为什么要使用</strong> <strong>Docker</strong>？</h3> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017094447494.png" alt="image-20241017094447494"></p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017094505939.png" alt="image-20241017094505939"></p> <h2 id="_2-核心概念与安装配置"><a href="#_2-核心概念与安装配置" class="header-anchor">#</a> 2. 核心概念与安装配置</h2> <h3 id="_2-1-核心概念"><a href="#_2-1-核心概念" class="header-anchor">#</a> 2.1 核心概念</h3> <h4 id="_2-1-1-docker-镜像"><a href="#_2-1-1-docker-镜像" class="header-anchor">#</a> 2.1.1 Docker 镜像</h4> <p>相当于是一个 root 文件系统, 比如官方镜像 ubuntu:16.04 就包含了完整的一套Ubuntu16.04最小系统的 root 文件系统. 镜像是创建 Docker 容器的基础. 通过版本管理和增量的文件系统, Docker 提供了一套十分简单的机制来创建和更新现有的镜像，用户可以从网上下载一个已经做好的应用镜像并直接使用</p> <h4 id="_2-1-2-docker-容器"><a href="#_2-1-2-docker-容器" class="header-anchor">#</a> 2.1.2 Docker 容器</h4> <p>Docker 容器类似于一个轻量级的沙箱，Docker 利用容器来运行和隔离应用. 容器是从镜像创建的应用运行实例. 可以将其启动、开始、停止、删除，而这些容器都是彼此相互隔离的、互不可见的. 可以把容器看做是一个简易版的 Linux 系统环境（包括root 用户权限、进程空间、用户空间和网络空间等）以及运行在其中的应用程序打包而成的盒子.</p> <p><strong>镜像自身是只读的. 容器从镜像启动的时候，会在镜像的最上层创建一个可写层. 同一个 image 文件, 可以生成多个同时运行的容器实例.</strong></p> <h4 id="_2-1-3-docker-仓库"><a href="#_2-1-3-docker-仓库" class="header-anchor">#</a> 2.1.3 Docker 仓库</h4> <p>Docker 仓库类似于代码仓库，它是 Docker 集中存放镜像文件的场所. Docker 利用仓库管理镜像的设计理念与 Git 非常相似，实际上在理念设计上借鉴了 Git 的很多优秀思想. Docker 仓库分为：</p> <ul><li><p>公开仓库(最大的公开仓库是官方提供的 Docker Hub,官网 https://hub.docker.com/ )</p></li> <li><p>私有仓库（Harbor）</p></li></ul> <h4 id="_2-1-4-docker-客户端"><a href="#_2-1-4-docker-客户端" class="header-anchor">#</a> 2.1.4 Docker 客户端</h4> <p>Docker 客户端通过命令行或者其他工具使用 Docker SDK (https://docs.docker.com/develop/sdk/) 与Docker 的守护进程通信. Docker 使用客户端-服务器 (C/S) 架构模式，使用远程 API 来管理和创建Docker 容器。</p> <h4 id="_2-1-5-docker-主机"><a href="#_2-1-5-docker-主机" class="header-anchor">#</a> 2.1.5 Docker 主机</h4> <p>一个用于执行 Docker 守护进程和容器的物理或者虚拟的机器.</p> <h4 id="_2-1-6-docker-machine"><a href="#_2-1-6-docker-machine" class="header-anchor">#</a> 2.1.6 Docker Machine</h4> <p>Docker Machine 是一个简化 Docker 安装的命令行工具，通过一个简单的命令行即可在相应的平台上安装 Docker，比如 VirtualBox、 Digital Ocean、Microsoft Azure</p> <h3 id="_2-2-安装配置"><a href="#_2-2-安装配置" class="header-anchor">#</a> 2.2 安装配置</h3> <h4 id="_2-2-1-linux-下安装最新版本的docker"><a href="#_2-2-1-linux-下安装最新版本的docker" class="header-anchor">#</a> 2.2.1 Linux 下安装最新版本的docker</h4> <h5 id="_2-2-1-1-ubuntu"><a href="#_2-2-1-1-ubuntu" class="header-anchor">#</a> 2.2.1.1 UBUNTU</h5> <p>此处推荐：curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun</p> <h5 id="_2-2-1-2-centos"><a href="#_2-2-1-2-centos" class="header-anchor">#</a> 2.2.1.2 Centos</h5> <p>此处推荐：curl -fsSL https://get.docker.com/ | sh</p> <h4 id="_2-2-2-windows"><a href="#_2-2-2-windows" class="header-anchor">#</a> 2.2.2 Windows</h4> <p>Docker 并非是一个通用的容器工具，它依赖于已存在并运行的 Linux 内核环境。Docker 实质上是在已经运行的 Linux 下制造了一个隔离的文件环境，因此它执行的效率几乎等同于所部署的 Linux 主机. 因此，Docker 必须部署在 Linux 内核的系统上. 如果其他系统想部署Docker 就必须安装一个虚拟 Linux 环境. 可以去官网上直接下载安装. 过程在此省略.</p> <h4 id="_2-2-3-macos"><a href="#_2-2-3-macos" class="header-anchor">#</a> 2.2.3 MacOS</h4> <p>参考：</p> <p>(1) 命令行安装 brew install --cask --appdir=/Applications docker</p> <p>(2) 可以直接去官网上下载安装镜像进行安装</p> <h4 id="_2-2-4-其他"><a href="#_2-2-4-其他" class="header-anchor">#</a> 2.2.4 其他</h4> <p>转到官网：https://www.docker.com/get-started/</p> <h3 id="_2-3-总体架构图"><a href="#_2-3-总体架构图" class="header-anchor">#</a> 2.3 总体架构图</h3> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017100309420.png" alt="image-20241017100309420"></p> <h2 id="_3-docker-的相关简单命令"><a href="#_3-docker-的相关简单命令" class="header-anchor">#</a> 3. Docker 的相关简单命令</h2> <h3 id="_3-1-基础命令"><a href="#_3-1-基础命令" class="header-anchor">#</a> 3.1 基础命令</h3> <p>docker version</p> <p>docekr info</p> <p>docker --help</p> <h3 id="_3-2-镜像相关命令"><a href="#_3-2-镜像相关命令" class="header-anchor">#</a> 3.2 镜像相关命令</h3> <table><thead><tr><th>序号</th> <th>帮助命令</th> <th>使用命令样例</th> <th>备注</th></tr></thead> <tbody><tr><td>1</td> <td>docker images --help</td> <td>docker images</td> <td>List images</td></tr> <tr><td>2</td> <td>docker pull --help</td> <td>docker pull ubuntu:13.10 <br>docker pull redis:5.0.12 <br>docker pull redis <br>docker pull 192.168.244.142:8443/library/redis:v6.0.8</td> <td>Pull an image or a repository froma registry</td></tr> <tr><td>3</td> <td>docker search --help</td> <td>docker search httpd</td> <td>Search the Docker Hub for images</td></tr> <tr><td>4</td> <td>docker commit --help</td> <td>docker pull ubuntu:14.04  <br>docker run -it ubuntu:14.04 /bin/bash  <br>root@bda3295636a3:/#  <br>root@bda3295636a3:/#  <br>touch 1.txt  <br>root@bda3295636a3:/#  <br>exit docker commit -m &quot;Added a new file&quot; -a &quot;Docker Newbee&quot; bda3295636a3 test:0.1 (bda3295636a3 是 containerid)</td> <td>Create a new image froma container's changes</td></tr> <tr><td>5</td> <td>docker build --help</td> <td>创建 Dockerfile，在 Dockerf 所在目录执行：  <br>docker build -t gcc-image:1.0 .</td> <td>Build an image from a Dockerfile (可见后续章节的例子)</td></tr> <tr><td>6</td> <td>docker tag --help</td> <td>docker pull redis:6.0.8 <br>docker tag redis:6.0.8 192.168.244.142:8443/library/redis:v6.0.8 <br>docker login https://192.168.244.142:8443/harbor -uadmin <br>docker push 192.168.244.142:8443/library/redis:v6.0.8</td> <td>Create a tag TARGET_IMAGE that referstoSOURCE_IMAGE</td></tr> <tr><td>7</td> <td>docker push --help</td> <td>docker push 192.168.244.142:8443/library/redis:v6.0.8</td> <td>Push an image or a repository to a registry</td></tr> <tr><td>8</td> <td>docker history --help</td> <td>docker history 1730c6f650e2 <br>docker history redis</td> <td>Show the history of an image</td></tr> <tr><td>9</td> <td>docker inspect --help</td> <td>docker inspect 87c26977fd90  <br>docker inspect redis</td> <td>Return low-level information on Docker objects</td></tr> <tr><td>10</td> <td>docker save --help</td> <td>docker save -o redis_6.0.8.tar redis:6.0.8   <br>docker save redis:6.0.8 &gt; redis_6.0.8-1.tar</td> <td>Save one or more images to a tar archive(streamedto STDOUT by default)</td></tr> <tr><td>11</td> <td>docker import --help</td> <td>wget http://download.openvz.org/template/precreated/ubuntu-14.04-x86_64-minimal.tar.gz<br> cat ubuntu-14.04-x86_64-minimal.tar.gz | docker import - ubuntu:14.04<br>docker images</td> <td>Import the contents froma tarball tocreateafilesystem image</td></tr> <tr><td>12</td> <td>docker export --help</td> <td>docker export harbor-jobservice &gt; harbor-jobservice.tar<br> (harbor-jobservice 是容器名)</td> <td>Export a container's filesystemas a tar archive</td></tr> <tr><td>13</td> <td>docker load --help</td> <td>docker load --input redis_6.0.8.tar</td> <td>Load an image from a tar archive or STDIN</td></tr> <tr><td>14</td> <td>docker rmi --help</td> <td>docker rmi 16ecd2772934(可以测试一下被多仓库引用) <br>docker rmi -f 16ecd2772934</td> <td>Remove one or more images</td></tr></tbody></table> <h3 id="_3-3-容器相关命令"><a href="#_3-3-容器相关命令" class="header-anchor">#</a> 3.3 容器相关命令</h3> <table><thead><tr><th>序号</th> <th>帮助命令</th> <th>使用样例</th> <th>备注</th></tr></thead> <tbody><tr><td>1</td> <td>docker create --help</td> <td>docker create -it ubuntu:latest</td> <td>Create a new container</td></tr> <tr><td>2</td> <td>docker run --help</td> <td>docker run -d --name redis-node-1 --net host --privileged=true -v /data/redis/share/redis-node-1:/data redis:6.0.8 --cluster-enabled yes --appendonly yes --port 6381 <br>docker run -dit -p 33899:3389 -m 1024M --memory-swap -1 --privileged --name LinuxFortContainer_tanghm linuxfort0318_1745 /start.sh 0f03cbf59a3549d3u7yx8mYKcKlXW2AN3dunfA== <br>docker run -d -p 80:80 --name webserver nginx</td> <td>Run a command in a new container  <br>docker run 只在第一次运行时使用,将镜像放到容器中,以后再次启动这个容器时,只需要使用命令 docker start 即可,docker run 相当于执行了两步操作:将镜像放入容器中(docker create),然后将容器启动,使之变成运行时容器(docker start), 参数说明：  <br>-d 后台运行容器,并返回容器 ID  <br>-i 交互式运行  <br>-t tty 终端  <br>--memory 限制容器可以使用的内存，如果没有指定--memory-swap那么默认和--memory 一样大  <br>eg: --memory 200m 没有--memory-swap 参数，那么容器可以使用的内存为400m  <br>--memory-swap 设置 swap 区可以使用的内存大小，默认和--memory一样大，必须&gt;=--memory  <br>--cpu-shares 表示占有 cpu 的相对权重 <br>eg: 假设在同一台物理主机上启动了如下2 个容器，容器1占用的cpu是容器 2 占有的 cpu 的 2 倍。  <br>同一台物理主机上  <br>容器 1: docker run -d --cpu-shares 10 ...  <br>容器 2: docker run -d --cpu-shares 5 ... - <br>-name 给容器起的名字  <br>--net 指定容器运行的网络 <br> -v 指定 volume 的路径  &lt;br / &gt;data volume 模式：  <br>别名：容器里面的路径 <br>mysql:/var/lib/mysql  <br>/var/lib/mysql 为 Dockerfile 中的volume 的值 <br>使用 docker volume ls 命令查看 <br>本地创建 mysql 数据卷： <br>docker create volume--namemysql  <br>bind mouting 模式：  <br>本地路径：容器路径  <br>/var/data:/var/容器目录 <br>本地目录和容器目录中的文件修改都会实时同步 <br>--ip 指定容器的 ip 地址  <br>-P 随机映射一个端口  <br>-p 本地端口：容器端口。 将容器中的某个端口映射到本地的某个端口上  <br>-e 设置环境变量  <br>--volumes-from 参数用于连接某个指定容器的卷，从而可以访问到指定容器中的所有的卷.  <br>--rm 表示容器运行完成后自动删除 <br>-h 设置 host 主机的名称</td></tr> <tr><td>3</td> <td>docker start --help</td> <td>docker start 36aebaa2ccb7 <br>docker start loving_pike</td> <td>Start one or more stopped containers  <br>start 的作用是,重新启动已存在的镜像, 也就是说，如果使用这个命令,我们必须事先知道这个容器的ID，或者这个容器的名字，我们可以使用dockerps -a 查看容器信息, 可对比 docker run 进行学习</td></tr> <tr><td>4</td> <td>docker restart --help</td> <td>docker restart 36aebaa2ccb7 <br>docker restart loving_pike</td> <td>Restart one or more containers  <br>36aebaa2ccb7--containerid  <br>loving_pike--containername</td></tr> <tr><td>5</td> <td>docker logs --help</td> <td>docker logs 36aebaa2ccb7 <br>docker logs loving_pike</td> <td>Fetch the logs of a container <br>36aebaa2ccb7--containerid <br>loving_pike--containername</td></tr> <tr><td>6</td> <td>docker stop --help</td> <td>docker stop 36aebaa2ccb7 <br>docker stop loving_pike</td> <td>Stop one or more running containers</td></tr> <tr><td>7</td> <td>docker kill --help</td> <td>docker kill 36aebaa2ccb7 <br>docker kill loving_pike</td> <td>Kill one or more running containers</td></tr> <tr><td>8</td> <td>docker ps --help</td> <td>--help docker ps -l 显示最近创建的容器(包括所有状态的容 器)</td> <td>List containers</td></tr> <tr><td>9</td> <td>docker attach --help</td> <td>docker run -itd --name ubuntu-test ubuntu /bin/bash  <br>docker attach 1146042c384e  <br>docker ps -a |grep 1146042c384e</td> <td>Attach local standard input, output, and error streams toarunningcontainer  <br>1146042c384e--containerid  <br>在使用-d 参数运行容器时, 容器启动后会进入后台, 此时想要进入容器, 可以通过这个指令进入, 不推荐大家使用dockerattach命令，因为使用它在退出容器终端，会导致容器的停止</td></tr> <tr><td>10</td> <td>docker exec --help</td> <td>docker run -itd --name ubuntu-test-01 ubuntu /bin/bash  <br>docker exec -it ubuntu-test-01 /bin/bash  <br>root@21bd6d174b21:/# exit  <br>docker ps -a | grep ubuntu-test-01</td> <td>Run a command in a running container <br>在使用 -d 参数运行容器时，容器启动后会进入后台, 此时想要进入容器，可以通过这个指令进入, 推荐大家使用dockerexec命令，因为使用它在退出容器终端，不会导致容器的停止</td></tr> <tr><td>11</td> <td>docker rm --help</td> <td>docker rm 1146042c384e</td> <td>Remove one or more containers</td></tr> <tr><td>12</td> <td>docker cp --help</td> <td>docker run -itd --name ubuntu-test ubuntu /bin/bash  <br>docker cp ubuntu-test:/ ./</td> <td>Copy files/folders between a container and the local filesystem</td></tr> <tr><td>13</td> <td>docker pause --help</td> <td>docker pause a1e5d03c3a0d <br>docker pause ubuntu-test</td> <td>Pause all processes within one or more containers</td></tr> <tr><td>14</td> <td>docker unpause --help</td> <td>docker unpause a1e5d03c3a0d <br>docker unpause ubuntu-test</td> <td>Unpause all processes within one or more containers</td></tr> <tr><td>15</td> <td>docker rename --help</td> <td>docker rename keen_cori keen_cori_new</td> <td>Rename a container</td></tr></tbody></table> <h3 id="_3-4-其他"><a href="#_3-4-其他" class="header-anchor">#</a> 3.4 其他</h3> <p>更多命令可以查阅相关数据或手册</p> <h2 id="_4-docker-网络"><a href="#_4-docker-网络" class="header-anchor">#</a> 4. Docker 网络</h2> <h3 id="_4-1-查看-docker-不启动和启动时的网络情况"><a href="#_4-1-查看-docker-不启动和启动时的网络情况" class="header-anchor">#</a> 4.1 查看 docker 不启动和启动时的网络情况</h3> <p>一台没怎么用过的 CentOS7 虚拟机一般有 ens33, lo, virbr0 这三个配置</p> <h3 id="_4-2-常用基本命令"><a href="#_4-2-常用基本命令" class="header-anchor">#</a> 4.2 常用基本命令</h3> <p>用【docker network --help】进行查看.</p> <h3 id="_4-3-docker-网络的用途"><a href="#_4-3-docker-网络的用途" class="header-anchor">#</a> 4.3 Docker 网络的用途</h3> <p>容器间的互联和通信以及端口映射;</p> <p>容器 IP 变动时候可以通过服务名直接网络通信而不受到影响</p> <h3 id="_4-4-网络模式"><a href="#_4-4-网络模式" class="header-anchor">#</a> 4.4 网络模式</h3> <h4 id="_4-4-1-分类"><a href="#_4-4-1-分类" class="header-anchor">#</a> 4.4.1 分类</h4> <table><thead><tr><th>Docker 网络模式</th> <th>配置</th> <th>说明</th></tr></thead> <tbody><tr><td>host 模式</td> <td>--net=host</td> <td>容器将不会虚拟出自己的网卡，配置自己的IP 等，而是使用宿主机的 IP 和端口</td></tr> <tr><td>container 模式</td> <td>--net=container:NAME_or_ID</td> <td>创建的容器不会创建自己的网卡，配置自己的IP，而是和一个指定的容器共享 IP、端口范围</td></tr> <tr><td>none</td> <td>--network none</td> <td>该模式关闭了容器的网络功能</td></tr> <tr><td>bridge 模式</td> <td>使用--network bridge 指定， 默认使用 docker0</td> <td>此模式会为每一个容器分配、设置IP 等，并将容器连接到一个 docker0 虚拟网桥，通过docker0 网桥以及 iptables nat 表配置与宿主之间的关联, 当 Docker 进程启动时，会在主机上创建一个名为docker0 的虚拟网桥，此主机上启动的Docker 容器会连接到这个虚拟网桥上。虚拟网桥的工作方式和物理交换机类似，这样主机上的所有容器就通过交换机连在了一个二层网络中.</td></tr></tbody></table> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017132956969.png" alt="image-20241017132956969"></p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017133004671.png" alt="image-20241017133004671"></p> <h4 id="_4-4-2-容器实例内默认网络-ip-生产规则"><a href="#_4-4-2-容器实例内默认网络-ip-生产规则" class="header-anchor">#</a> 4.4.2 容器实例内默认网络 IP 生产规则</h4> <p>docker 容器内部的 ip 是有可能会发生改变的.</p> <h4 id="_4-4-3-简单测试"><a href="#_4-4-3-简单测试" class="header-anchor">#</a> 4.4.3 简单测试</h4> <p>docker run -d -p 8081:8080 --name tomcate81 billygoo/tomcat8-jdk8</p> <p>docker run -d -p 8082:8080 --name tomcate82 billygoo/tomcat8-jdk8</p> <p>docker run -d -p 8083:8080 --network host --name tomcat83 billygoo/tomcat8-jdk8</p> <p>docker run -d -p 8083:8080 --name tomcat84 billygoo/tomcat8-jdk8</p> <h4 id="_4-4-4-端口映射的简单示例"><a href="#_4-4-4-端口映射的简单示例" class="header-anchor">#</a> 4.4.4 端口映射的简单示例</h4> <p>(1) 使用-P 来做映射宿主机的指定端口, 例如【docker run -d -P redis】</p> <p>(2) 使用【-p IP::ContainerPort】 映射到指定地址的任意端口，使用IP::ContainerPort 绑定localhost 的任意端口到容器的 6379 端口，本地主机会自动分配一个端口, 例如【docker run-d-p 127.0.0.1::6379 redis】</p> <p>(3）使用【-p IP:HostPort:ContainerPort】映射到指定地址的指定端口，例如【docker run -d-p127.0.0.1:6379:6379 redis】</p> <p>(4) 使用【-p HostPort:ContainerPort】映射所有接口地址 ,例如【docker run -d -p 6379:6379-p5000:5000 redis】</p> <h2 id="_5-dockerfile"><a href="#_5-dockerfile" class="header-anchor">#</a> 5.Dockerfile</h2> <h3 id="_5-1-基本结构"><a href="#_5-1-基本结构" class="header-anchor">#</a> 5.1 基本结构</h3> <h4 id="_5-1-1-说明"><a href="#_5-1-1-说明" class="header-anchor">#</a> 5.1.1 说明</h4> <p>Dockerfile 由一行行命令语句组成，并且支持以#开头的注释行。一般而言，Dockerfile 分为四部分：基础镜像信息、维护者信息、镜像操作指令和容器启动时执行指令。例如：</p> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token comment"># This Dockerfile uses the ubuntu image</span>
<span class="token comment"># VERSION 2 - EDITION 1</span>
<span class="token comment"># Author: docker_user </span>
<span class="token comment"># Command format: Instruction [arguments / command] .. </span>
<span class="token comment"># Base image to use, this must be set as the first line </span>
<span class="token instruction"><span class="token keyword">FROM</span> ubuntu</span>
<span class="token comment"># Maintainer: docker_user &lt;docker_user at email.com&gt; (@docker_user)</span>
<span class="token instruction"><span class="token keyword">MAINTAINER</span> docker_user docker_user@email.com</span>
<span class="token comment"># Commands to update the image </span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;deb http://archive.ubuntu.com/ubuntu/ raring main universe&quot;</span> &gt;&gt; /etc/apt/ </span>
sources.list 
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; apt-get install -y nginx </span>
<span class="token instruction"><span class="token keyword">RUN</span> echo <span class="token string">&quot;\ndaemon off;&quot;</span> &gt;&gt; /etc/nginx/nginx.conf </span>
<span class="token comment"># Commands when creating a new container </span>
<span class="token instruction"><span class="token keyword">CMD</span> /usr/sbin/nginx</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_5-1-2-基于-debian-jessie-镜像安装nginx-的dockerfile示例"><a href="#_5-1-2-基于-debian-jessie-镜像安装nginx-的dockerfile示例" class="header-anchor">#</a> 5.1.2 基于 debian:jessie 镜像安装Nginx 的Dockerfile示例</h4> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> debian:jessie </span>
<span class="token instruction"><span class="token keyword">MAINTAINER</span> NGINX Docker Maintainers <span class="token string">&quot;docker-maint@nginx.com&quot;</span> </span>
<span class="token instruction"><span class="token keyword">ENV</span> NGINX_VERSION 1.10.1-1~jessie </span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-key adv --keyserver hkp://pgp.mit.edu:80 --recv-keys 573BFD6B3D8FBC64107</span>
	9A6ABABF5BD827BD9BF62 \ 
	&amp;&amp; echo &quot;deb http://nginx.org/packages/debian/ jessie nginx&quot; &gt;&gt; /etc/ 
		apt/sources.list \ 
	&amp;&amp; apt-get update \ 
	&amp;&amp; apt-get install --no-install-recommends --no-install-suggests -y \ 
	ca-certificates \ 
	nginx=${NGINX_VERSION} \ 
	nginx-module-xslt \ 
	nginx-module-geoip \ 
	nginx-module-image-filter \ 
	nginx-module-perl \ 
	nginx-module-njs \ 
	gettext-base \ 
	&amp;&amp; rm -rf /var/lib/apt/lists/*
<span class="token comment"># forward request and error logs to docker log collector </span>
<span class="token instruction"><span class="token keyword">RUN</span> ln -sf /dev/stdout /var/log/nginx/access.log \ </span>
	&amp;&amp; ln -sf /dev/stderr /var/log/nginx/error.log 
<span class="token instruction"><span class="token keyword">EXPOSE</span> 80 443 </span>
<span class="token instruction"><span class="token keyword">CMD</span> [<span class="token string">&quot;nginx&quot;</span>, <span class="token string">&quot;-g&quot;</span>, <span class="token string">&quot;daemon off;&quot;</span>]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h4 id="_5-1-3-基于buildpack-deps-jessie-scm镜像安装golang相关环境的-dockerfile-示例"><a href="#_5-1-3-基于buildpack-deps-jessie-scm镜像安装golang相关环境的-dockerfile-示例" class="header-anchor">#</a> 5.1.3 基于buildpack-deps:jessie-scm镜像安装Golang相关环境的 Dockerfile 示例</h4> <div class="language-dockerfile line-numbers-mode"><pre class="language-dockerfile"><code><span class="token instruction"><span class="token keyword">FROM</span> buildpack-deps:jessie-scm</span>
<span class="token comment"># gcc for cgo </span>
<span class="token instruction"><span class="token keyword">RUN</span> apt-get update &amp;&amp; apt-get install -y --no-install-recommends <span class="token operator">\</span>
	g++ \ </span>
	gcc \
	libc6-dev \ 
	make \ 
	&amp;&amp; rm -rf /var/lib/apt/lists/* 
<span class="token instruction"><span class="token keyword">ENV</span> GOLANG_VERSION 1.6.3 </span>
<span class="token instruction"><span class="token keyword">ENV</span> GOLANG_DOWNLOAD_URL https://golang.org/dl/go<span class="token variable">$GOLANG_VERSION</span>.linux-amd64.tar.gz </span>
<span class="token instruction"><span class="token keyword">ENV</span> GOLANG_DOWNLOAD_SHA256 cdde5e08530c0579255d6153b08fdb3b8e47caabbe717bc7bcd7561275a87aeb </span>
<span class="token instruction"><span class="token keyword">RUN</span> curl -fsSL <span class="token string">&quot;$GOLANG_DOWNLOAD_URL&quot;</span> -o golang.tar.gz \ </span>
	&amp;&amp; echo &quot;$GOLANG_DOWNLOAD_SHA256 golang.tar.gz&quot; | sha256sum -c - \
    &amp;&amp; tar -C /usr/local -xzf golang.tar.gz \ 
    &amp;&amp; rm golang.tar.gz 
<span class="token instruction"><span class="token keyword">ENV</span> GOPATH /go </span>
<span class="token instruction"><span class="token keyword">ENV</span> PATH <span class="token variable">$GOPATH</span>/bin:/usr/local/go/bin:<span class="token variable">$PATH</span></span>
<span class="token instruction"><span class="token keyword">RUN</span> mkdir -p <span class="token string">&quot;$GOPATH/src&quot;</span> <span class="token string">&quot;$GOPATH/bin&quot;</span> &amp;&amp; chmod -R 777 <span class="token string">&quot;$GOPATH&quot;</span> </span>
<span class="token instruction"><span class="token keyword">WORKDIR</span> <span class="token variable">$GOPATH</span></span>
<span class="token instruction"><span class="token keyword">COPY</span> go-wrapper /usr/local/bin/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="_5-1-4-永远的-helloworld-java"><a href="#_5-1-4-永远的-helloworld-java" class="header-anchor">#</a> 5.1.4 永远的 helloworld(JAVA)</h4> <p>/root/dockerStudy/20220330/javaHelloWorld</p> <p>(1)编写 Makefile</p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017133922215.png" alt="image-20241017133922215"></p> <p>(2)构造镜像</p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017133939044.png" alt="image-20241017133939044"></p> <p>(3) 运行镜像</p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017133955468.png" alt="image-20241017133955468"></p> <h3 id="_5-2-指令说明"><a href="#_5-2-指令说明" class="header-anchor">#</a> 5.2 指令说明</h3> <p>指令的一般格式为 INSTRUCTION arguments，指令包括 FROM、MAINTAINER、RUN 等，参见下表：</p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017134151771.png" alt="image-20241017134151771"></p> <h3 id="_5-3-最佳实践"><a href="#_5-3-最佳实践" class="header-anchor">#</a> 5.3 最佳实践</h3> <p>所谓最佳实践，实际上是从需求出发，来定制适合自己、高效方便的镜像。</p> <p>首先，要尽量吃透每个指令的含义和执行效果，自己多编写一些简单的例子进行测试，弄清楚了再撰写正式的 Dockerfile。此外，Docker Hub 官方仓库中提供了大量的优秀镜像和对应的 Dockefile，可以通过阅读它们来学习如何撰写高效的 Dockerfile。</p> <p>通过前辈总结了的一些实践经验，建议在生成镜像过程中，尝试从如下角度进行思考，完善所生成的镜像。</p> <ul><li>精简镜像用途： 尽量让每个镜像的用途都比较集中、单一，避免构造大而复杂、多功能的镜像；</li> <li>选用合适的基础镜像： 过大的基础镜像会造成生成臃肿的镜像，一般推荐较为小巧的debian 镜像；</li> <li>提供足够清晰的命令注释和维护者信息： Dockerfile 也是一种代码，需要考虑方便后续扩展和他人使用；</li> <li>正确使用版本号： 使用明确的版本号信息，如 1.0，2.0，而非 latest，将避免内容不一致可能引发的惨案；</li> <li>·减少镜像层数： 如果希望所生成镜像的层数尽量少，则要尽量合并指令，例如多个RUN指令可以合并为一条；</li> <li>及时删除临时文件和缓存文件： 特别是在执行 apt-get 指令后，/var/cache/apt 下面会缓存一些安装包；</li> <li>提高生成速度： 如合理使用缓存，减少内容目录下的文件，或使用.dockerignore 文件指定等；</li> <li>调整合理的指令顺序： 在开启缓存的情况下，内容不变的指令尽量放在前面，这样可以尽量复用；</li> <li>减少外部源的干扰： 如果确实要从外部引入数据，需要指定持久的地址，并带有版本信息，让他人可以重复而不出错。</li></ul> <h3 id="_5-4-推荐一个-dockerfile-项目"><a href="#_5-4-推荐一个-dockerfile-项目" class="header-anchor">#</a> 5.4 推荐一个 Dockerfile 项目</h3> <p>Docker 公司在 Github 上维护了一个 Dockerfile 项目（https://github.com/dockerfile ），该项目为一些常见开源软件服务提供 Dockerfile 和自动构建方案。开发者可以根据该工程中的各服务介绍和 Dockerfile 来快速开发、测试和部署新的应用程序。</p> <h2 id="_6-容器实战思考"><a href="#_6-容器实战思考" class="header-anchor">#</a> 6.容器实战思考</h2> <h3 id="_6-1-docker-成功的原因"><a href="#_6-1-docker-成功的原因" class="header-anchor">#</a> 6.1 Docker 成功的原因</h3> <p>虽然 Docker 所依赖的容器技术存在已久，但 Docker 的出现才真正提供了易用的解决方案</p> <ul><li>Docker 首次创造了一种简单易行并且覆盖应用全生命周期的工作流，用户可以通过简单的指令或 Restful API 来拉取、打包、运行和维护容器.</li> <li>Docker 提供了一种统一的实践方法，每个服务（或应用）维护一个Dockerfile 文件</li> <li>Docker 正以一种前所未有的方式让用户可以在各种 Linux 发行版、各种开发环境中快速切换，这对应用开发者来说真是一种福音.</li></ul> <p><strong>真正解决用户痛点，真正带来效率的提升，是一个产品和技术能最终成功的关键</strong></p> <h3 id="_6-2-研发人员怎么看-docker"><a href="#_6-2-研发人员怎么看-docker" class="header-anchor">#</a> 6.2 研发人员怎么看 Docker</h3> <ul><li>快速上手新技术</li> <li>容器化的代码仓库让工作更高效</li> <li>面向业务编程，使用 Docker 快速掌握新技术要点并完成适当的技术储备，在工期紧急时可更好地专注业务开发</li> <li>使用 Docker Hub 发布开源项目和学习</li></ul> <h3 id="_6-3-容器化开发模式"><a href="#_6-3-容器化开发模式" class="header-anchor">#</a> 6.3 容器化开发模式</h3> <h4 id="_6-3-1-传统开发流程与容器化开发流程"><a href="#_6-3-1-传统开发流程与容器化开发流程" class="header-anchor">#</a> 6.3.1 传统开发流程与容器化开发流程</h4> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017134533763.png" alt="image-20241017134533763"></p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017134545484.png" alt="image-20241017134545484"></p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017134555302.png" alt="image-20241017134555302"></p> <h4 id="_6-3-2-一些建议"><a href="#_6-3-2-一些建议" class="header-anchor">#</a> 6.3.2 一些建议</h4> <p>首先，在开发和测试环境中，推荐使用-v 共享文件夹来存储开发人员的程序代码，避免频繁打包操作;</p> <p>其次，利用基础 base 镜像的继承特性来调整镜像的轻微变更. 例如当需要测试程序对不同版本 JDK 的支持情况时，只需改变 base 镜像的 JDK 设置，然后其他依赖它的镜像在重新创建的过程中就可以自动完成更新;</p> <p>最后，测试部门应当注意 Docker 以及镜像的版本，并经常对部署后的应用程序进行性能上的测试.</p> <h3 id="_6-4-容器与生产环境"><a href="#_6-4-容器与生产环境" class="header-anchor">#</a> 6.4 容器与生产环境</h3> <h4 id="_6-4-1-为标准而努力"><a href="#_6-4-1-为标准而努力" class="header-anchor">#</a> 6.4.1 为标准而努力</h4> <p>尽管 Docker 获得广大公有云厂商的大力支持，但是目前容器技术生态中已经存在许多分支与分歧，如 rkt 项目。为了解决容器生态中的差异化问题，为了从根本上解决生产环境中运用 Docker 的风险，Google、Intel、Microsoft、IBM、Amazon、VMware、Oracle、HPE、Facebook等 IT 巨头于 2015 年 6 月共同宣布成立 OCI（Open Container Initiative）组织。OCI 组织的目标在于 . 除了保障与延续既有容器服务的生命周期外，还通过不断推出标准的创新的容器解决方案赋能开发者. OCI组织的目标在于建立通用的容器技术标准。除了保障与延续既有容器服务的生命周期外， 还通过不断推出标准的创新的容器解决方案赋能开发者.</p> <blockquote><p>注：rkt 项目最早跟随 k8s 使用的运行时的组件，并且也入选过 cncf 的沙箱项目，但是在最后的使用中还是被抛弃了，其中主要的是 croi-o 和 containerd 两个项目的接受度更高，并且社区活跃度越来越低，最终停止维护。</p></blockquote> <h4 id="_6-4-2-一些参考建议"><a href="#_6-4-2-一些参考建议" class="header-anchor">#</a> 6.4.2 一些参考建议</h4> <ul><li>如果 Docker 出现不可控的风险，是否考虑了备选的解决方案；</li> <li>是否需要对 Docker 容器做资源限制，以及如何限制，如 CPU、内存、网络、磁盘等；</li> <li>目前，Docker 对容器的安全管理做得不够完善，在应用到生产环境之前可以使用第三方工具来加强容器的安全管理。如使用 apparmor(类似于 selinux)对容器的能力进行限制、使用更加严格的 iptable 规则、禁止 root 用户登录、限制普通用户权限以及做好系统日志的记录；</li> <li>公司内部私有仓库的管理、镜像的管理问题是否解决. 目前官方提供的私有仓库管理工具功能并不十分完善，若在生产环境中使用还需要更多的工作.</li></ul> <h2 id="_7-可继续的docker-相关学习与研究"><a href="#_7-可继续的docker-相关学习与研究" class="header-anchor">#</a> 7.可继续的Docker 相关学习与研究</h2> <p>(1)Docker 核心实现技术,包括基本架构,命名空间,控制组,联合文件系统,Linux 网络虚拟化;</p> <p>(2)Docker 中关于网络的高级知识,包括网络的启动和配置参数、DNS 的使用配置、容器访问和端口映射的相关实现;</p> <p>(3)Docker 三剑客-Docker Machine,Docker Compose,Docker Swarm;</p> <p>(4)Mesos-优秀的集群资源调度平台;</p> <p>(5)Kubernetes—生产级容器集群平台;</p> <p>(6)源码的研读;</p> <p>.......</p> <h2 id="_8-推荐网站与书籍"><a href="#_8-推荐网站与书籍" class="header-anchor">#</a> 8. 推荐网站与书籍</h2> <p>网站：</p> <p>docker 官网: https://www.docker.com/</p> <p>dockerhub 官网： https://hub.docker.com/</p> <p>docker 菜鸟课程: https://www.runoob.com/docker/docker-tutorial.html</p> <p>Docker 官方文档：https://docs.docker.com/</p> <p>书籍：</p> <p>《docker 容器实战：原理、架构与应用》</p> <p>《Docker 技术入门与实战》</p> <p>《第一本 Docker 书》</p> <p>《Docker 进阶与实战 华为 Docker 实践小组》</p> <p>《Docker 源码分析》</p> <p>......</p> <p><img src="https://raw.githubusercontent.com/zhaoyb-coder/pic-repo/main/image-20241017134838976.png" alt="image-20241017134838976"></p></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=docker" title="标签">#docker</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/10/22, 09:11:37</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/4dbc02/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">k8s配置Containerd</div></a> <a href="/k8s/docker/100002/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Cgroup</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/4dbc02/" class="prev">k8s配置Containerd</a></span> <span class="next"><a href="/k8s/docker/100002/">Cgroup</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/be/activiti-04/"><div>
            Activiti6-业务实现
            <!----></div></a> <span class="date">12-06</span></dt></dl><dl><dd>02</dd> <dt><a href="/be/activiti-03/"><div>
            Activiti6-API详解
            <!----></div></a> <span class="date">11-28</span></dt></dl><dl><dd>03</dd> <dt><a href="/be/activiti-02/"><div>
            SpringBoot集成Activiti和UI
            <!----></div></a> <span class="date">11-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><!----> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2022-2024
    <span>赵宇博 | <a href="https://github.com/zhaoyb-coder/" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.e1cac8e6.js" defer></script><script src="/assets/js/2.1e4db32b.js" defer></script><script src="/assets/js/28.9f795e29.js" defer></script>
  </body>
</html>
